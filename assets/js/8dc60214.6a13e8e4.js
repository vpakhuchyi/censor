"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[457],{8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const i={},o=r.createContext(i);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(o.Provider,{value:n},e.children)}},8808:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"security-best-practices/common-data-leak-scenarios","title":"Common Data Leak Scenarios","description":"This guide covers common scenarios where sensitive data might be leaked and how to prevent them using Censor.","source":"@site/docs/security-best-practices/common-data-leak-scenarios.md","sourceDirName":"security-best-practices","slug":"/security-best-practices/common-data-leak-scenarios","permalink":"/censor/security-best-practices/common-data-leak-scenarios","draft":false,"unlisted":false,"editUrl":"https://github.com/vpakhuchyi/censor-doc/tree/main/docs/security-best-practices/common-data-leak-scenarios.md","tags":[],"version":"current","lastUpdatedBy":"Viktor","lastUpdatedAt":1743858422000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1}}');var i=s(4848),o=s(8453);const a={sidebar_position:1},l="Common Data Leak Scenarios",t={},c=[{value:"Logging Sensitive Data",id:"logging-sensitive-data",level:2},{value:"Problem",id:"problem",level:3},{value:"Solution",id:"solution",level:3},{value:"API Responses",id:"api-responses",level:2},{value:"Problem",id:"problem-1",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Error Messages",id:"error-messages",level:2},{value:"Problem",id:"problem-2",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Debug Information",id:"debug-information",level:2},{value:"Problem",id:"problem-3",level:3},{value:"Solution",id:"solution-3",level:3},{value:"Database Queries",id:"database-queries",level:2},{value:"Problem",id:"problem-4",level:3},{value:"Solution",id:"solution-4",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Example Implementation",id:"example-implementation",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"common-data-leak-scenarios",children:"Common Data Leak Scenarios"})}),"\n",(0,i.jsx)(n.p,{children:"This guide covers common scenarios where sensitive data might be leaked and how to prevent them using Censor."}),"\n",(0,i.jsx)(n.h2,{id:"logging-sensitive-data",children:"Logging Sensitive Data"}),"\n",(0,i.jsx)(n.h3,{id:"problem",children:"Problem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// BAD: Logging sensitive data directly\nlogger.Info("user login", zap.String("email", user.Email), zap.String("password", user.Password))\n'})}),"\n",(0,i.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// GOOD: Using Censor to mask sensitive data\nlogger := zap.New(censorlog.NewHandler(...))\nlogger.Info("user login", zap.Any("user", user))\n// Output: {"level":"info","msg":"user login","user":{"Email":"[CENSORED]","Password":"[CENSORED]"}}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"api-responses",children:"API Responses"}),"\n",(0,i.jsx)(n.h3,{id:"problem-1",children:"Problem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"// BAD: Returning sensitive data in API responses\nfunc (h *Handler) GetUser(w http.ResponseWriter, r *http.Request) {\n    user := h.getUserFromDB()\n    json.NewEncoder(w).Encode(user) // Might expose sensitive fields\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"solution-1",children:"Solution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"// GOOD: Using Censor to sanitize API responses\nfunc (h *Handler) GetUser(w http.ResponseWriter, r *http.Request) {\n    user := h.getUserFromDB()\n    c := censor.New()\n    sanitized := c.Process(user)\n    json.NewEncoder(w).Encode(sanitized)\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"error-messages",children:"Error Messages"}),"\n",(0,i.jsx)(n.h3,{id:"problem-2",children:"Problem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// BAD: Including sensitive data in error messages\nif err != nil {\n    return fmt.Errorf("failed to process payment for card %s: %v", card.Number, err)\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"solution-2",children:"Solution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// GOOD: Using Censor for error messages\nif err != nil {\n    c := censor.New()\n    maskedCard := c.Process(card)\n    return fmt.Errorf("failed to process payment: %v", err)\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"debug-information",children:"Debug Information"}),"\n",(0,i.jsx)(n.h3,{id:"problem-3",children:"Problem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// BAD: Including sensitive data in debug logs\ndebug.Printf("Processing request: %+v", request)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"solution-3",children:"Solution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// GOOD: Using Censor for debug information\nc := censor.New()\ndebug.Printf("Processing request: %v", c.Process(request))\n'})}),"\n",(0,i.jsx)(n.h2,{id:"database-queries",children:"Database Queries"}),"\n",(0,i.jsx)(n.h3,{id:"problem-4",children:"Problem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// BAD: Logging raw SQL queries with sensitive data\nlogger.Debug("executing query", zap.String("query", query), zap.Any("params", params))\n'})}),"\n",(0,i.jsx)(n.h3,{id:"solution-4",children:"Solution"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'// GOOD: Using Censor for query parameters\nc := censor.New()\nlogger.Debug("executing query", \n    zap.String("query", query), \n    zap.Any("params", c.Process(params)))\n'})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Always Use Censor for Logging"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Configure your logger with Censor handler"}),"\n",(0,i.jsx)(n.li,{children:"Process all data before logging"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Define Clear Data Policies"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use struct tags to mark sensitive fields"}),"\n",(0,i.jsx)(n.li,{children:"Document which fields should be masked"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Handle Edge Cases"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Consider nested structures"}),"\n",(0,i.jsx)(n.li,{children:"Process data at the boundaries of your system"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Regular Audits"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Review logs for potential leaks"}),"\n",(0,i.jsx)(n.li,{children:"Test data sanitization regularly"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuration Management"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Keep sensitive configuration masked"}),"\n",(0,i.jsx)(n.li,{children:"Use environment variables with Censor"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-implementation",children:"Example Implementation"}),"\n",(0,i.jsx)(n.p,{children:"Here's a complete example showing these practices:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "encoding/json"\n    "net/http"\n    "github.com/vpakhuchyi/censor"\n    "github.com/vpakhuchyi/censor/logger/zap"\n    "go.uber.org/zap"\n)\n\ntype User struct {\n    ID       string `json:"id" censor:"display"`\n    Email    string `json:"email"`\n    Password string `json:"password"`\n    APIKey   string `json:"api_key"`\n}\n\ntype Handler struct {\n    logger *zap.Logger\n    censor *censor.Censor\n}\n\nfunc NewHandler() *Handler {\n    // Create a Censor instance\n    c := censor.New()\n\n    // Create a logger with Censor handler\n    logger := zap.New(censorlog.NewHandler(...))\n\n    return &Handler{\n        logger: logger,\n        censor: c,\n    }\n}\n\nfunc (h *Handler) GetUser(w http.ResponseWriter, r *http.Request) {\n    user := h.getUserFromDB()\n\n    // Log the request (safely)\n    h.logger.Info("processing user request",\n        zap.Any("user", user),\n        zap.String("path", r.URL.Path))\n\n    // Return sanitized response\n    sanitized := h.censor.Process(user)\n    json.NewEncoder(w).Encode(sanitized)\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Learn about ",(0,i.jsx)(n.a,{href:"../configuration",children:"Configuration"})," for customizing Censor"]}),"\n",(0,i.jsxs)(n.li,{children:["Check out ",(0,i.jsx)(n.a,{href:"../type-handling/overview",children:"Type Support"})," to understand data handling"]}),"\n",(0,i.jsxs)(n.li,{children:["See ",(0,i.jsx)(n.a,{href:"../logger-handlers/zap",children:"Logger Integration"})," for logging security"]}),"\n",(0,i.jsxs)(n.li,{children:["Explore ",(0,i.jsx)(n.a,{href:"../examples/data-leak-prevention",children:"Examples"})," for practical usage"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);